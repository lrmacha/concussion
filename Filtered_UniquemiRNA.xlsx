import pandas as pd
import os

# Set the full file path
file_path = r'C:\Users\lrmacha\Downloads\UniquemiRNAs.xlsx'

# Read both sheets
Sheet1 = pd.read_excel(file_path, sheet_name=0, header=0)
Sheet2 = pd.read_excel(file_path, sheet_name=1, header=0)

# Create temporary uppercase copies for comparison (without modifying original columns)
gene_ids_upper = Sheet1['gene_id'].astype(str).str.upper()
id_column_upper = Sheet2['#ID'].astype(str).str.upper()

# Use the uppercase values for filtering
genes_of_interest = gene_ids_upper.dropna().unique()
filtered = Sheet2[id_column_upper.isin(genes_of_interest)]

# Output path
output_path = r'C:\Users\lrmacha\Downloads\Filtered_UniquemiRNA.xlsx'

# Save result with original formatting
filtered.to_excel(output_path, index=False)

print(f"‚úÖ Filtered file saved to: {output_path}")
print(f"üîç Matching rows: {len(filtered)}")
